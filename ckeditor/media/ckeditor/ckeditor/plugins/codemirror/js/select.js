var select={};
(function(){function o(b,c){for(;b&&b.parentNode!=c;)b=b.parentNode;return b}function t(b,c){for(;!b.previousSibling&&b.parentNode!=c;)b=b.parentNode;return o(b.previousSibling,c)}select.ie_selection=document.selection&&document.selection.createRangeCollection;select.scrollToNode=function(b,c){if(b){var a=b,d=a.ownerDocument,f=d.body,e=d.defaultView||d.parentWindow;d=d.documentElement;for(var g=!a.nextSibling||!a.nextSibling.nextSibling||!a.nextSibling.nextSibling.nextSibling,h=0;a&&!a.offsetTop;){h++;
a=a.previousSibling}if(h==0)g=false;if(!(webkit&&a&&a.offsetTop==5&&a.offsetLeft==5)){h=h*(a?a.offsetHeight:0);var k=0,m=b?b.offsetWidth:0;for(a=a;a&&a.offsetParent;){h+=a.offsetTop;isBR(a)||(k+=a.offsetLeft);a=a.offsetParent}a=f.scrollLeft||d.scrollLeft||0;f=f.scrollTop||d.scrollTop||0;var i=false,l=e.innerWidth||d.clientWidth||0;if(c||m<l){if(c){var p=select.offsetInNode(e,b),n=nodeText(b).length;if(n)k+=m*(p/n)}m=k-a;if(m<0||m>l){a=k;i=true}}k=h-f;if(k<0||g||k>(e.innerHeight||d.clientHeight||0)-
50){f=g?1E6:h;i=true}i&&e.scrollTo(a,f)}}};select.scrollToCursor=function(b){select.scrollToNode(select.selectionTopNode(b,true)||b.firstChild,true)};var j=null;select.snapshotChanged=function(){if(j)j.changed=true};select.snapshotReplaceNode=function(b,c,a,d){function f(e){if(b==e.node){j.changed=true;if(a&&e.offset>a)e.offset-=a;else{e.node=c;e.offset+=d||0}}}if(j){f(j.start);f(j.end)}};select.snapshotMove=function(b,c,a,d,f){function e(g){if(b==g.node&&(!f||g.offset==0)){j.changed=true;g.node=
c;g.offset=d?Math.max(0,g.offset+a):a}}if(j){e(j.start);e(j.end)}};if(select.ie_selection){var u=function(b,c){function a(i){for(var l=null;!l&&i;){l=i.nextSibling;i=i.parentNode}return d(l)}function d(i){for(;i&&i.firstChild;)i=i.firstChild;return{node:i,offset:0}}var f=b.document.selection.createRange();f.collapse(c);var e=f.parentElement();if(!isAncestor(b.document.body,e))return null;if(!e.firstChild)return d(e);var g=f.duplicate();g.moveToElementText(e);g.collapse(true);for(var h=e.firstChild;h;h=
h.nextSibling){if(h.nodeType==3){var k=h.nodeValue.length;g.move("character",k)}else{g.moveToElementText(h);g.collapse(false)}var m=f.compareEndPoints("StartToStart",g);if(m==0)return a(h);if(m!=1){if(h.nodeType!=3)return d(h);g.setEndPoint("StartToEnd",f);return{node:h,offset:k-g.text.length}}}return a(e)};select.markSelection=function(b){j=null;if(b.document.selection){var c=u(b,true),a=u(b,false);if(c&&a)j={start:c,end:a,window:b,changed:false}}};select.selectMarked=function(){function b(f){var e=
c.body.createTextRange(),g=f.node;if(g)if(g.nodeType==3){e.moveToElementText(g.parentNode);for(f=f.offset;g.previousSibling;){g=g.previousSibling;f+=(g.innerText||"").length}e.move("character",f)}else{e.moveToElementText(g);e.collapse(true)}else{e.moveToElementText(j.window.document.body);e.collapse(false)}return e}if(j&&j.changed){var c=j.window.document,a=b(j.start),d=b(j.end);a.setEndPoint("StartToEnd",d);a.select()}};select.offsetInNode=function(b,c){var a=b.document.selection;if(!a)return 0;
a=a.createRange();var d=a.duplicate();try{d.moveToElementText(c)}catch(f){return 0}a.setEndPoint("StartToStart",d);return a.text.length};select.selectionTopNode=function(b,c){function a(k,m){if(m.nodeType==3){for(var i=0,l=m.previousSibling;l&&l.nodeType==3;){i+=l.nodeValue.length;l=l.previousSibling}if(l){try{k.moveToElementText(l)}catch(p){return false}k.collapse(false)}else k.moveToElementText(m.parentNode);i&&k.move("character",i)}else try{k.moveToElementText(m)}catch(n){return false}return true}
var d=b.ownerDocument.selection;if(!d)return false;d=d.createRange();var f=d.duplicate();d.collapse(c);var e=d.parentElement();if(e&&isAncestor(b,e)){f.moveToElementText(e);if(d.compareEndPoints("StartToStart",f)==1)return o(e,b)}c=0;for(e=b.childNodes.length-1;c<e;){var g=Math.ceil((e+c)/2),h=b.childNodes[g];if(!h)return false;if(!a(f,h))return false;if(d.compareEndPoints("StartToStart",f)==1)c=g;else e=g-1}return b.childNodes[c]||null};select.focusAfterNode=function(b,c){var a=c.ownerDocument.body.createTextRange();
a.moveToElementText(b||c);a.collapse(!b);a.select()};select.somethingSelected=function(b){return(b=b.document.selection)&&b.createRange().text!=""};var v=function(b,c){var a=b.document.selection;if(a){a=a.createRange();a.pasteHTML(c);a.collapse(false);a.select()}};select.insertNewlineAtCursor=function(b){v(b,"<br>")};select.insertTabAtCursor=function(b){v(b,"\u00a0\u00a0\u00a0\u00a0")};select.cursorPos=function(b,c){var a=b.ownerDocument.selection;if(!a)return null;for(var d=select.selectionTopNode(b,
c);d&&!isBR(d);)d=d.previousSibling;a=a.createRange();var f=a.duplicate();a.collapse(c);if(d){f.moveToElementText(d);f.collapse(false)}else{try{f.moveToElementText(b)}catch(e){return null}f.collapse(true)}a.setEndPoint("StartToStart",f);return{node:d,offset:a.text.length}};select.setCursorPos=function(b,c,a){function d(e){var g=b.ownerDocument.body.createTextRange();if(e.node){g.moveToElementText(e.node);g.collapse(false)}else{g.moveToElementText(b);g.collapse(true)}g.move("character",e.offset);return g}
var f=d(c);a&&a!=c&&f.setEndPoint("EndToEnd",d(a));f.select()};select.getBookmark=function(b){var c=select.cursorPos(b,true);b=select.cursorPos(b,false);if(c&&b)return{from:c,to:b}};select.setBookmark=function(b,c){c&&select.setCursorPos(b,c.from,c.to)}}else{var s=function(b,c){for(;b.nodeType!=3&&!isBR(b);){var a=b.childNodes[c]||b.nextSibling;for(c=0;!a&&b.parentNode;){b=b.parentNode;a=b.nextSibling}b=a;if(!a)break}return{node:b,offset:c}};select.markSelection=function(b){var c=b.getSelection();
if(!c||c.rangeCount==0)return j=null;c=c.getRangeAt(0);j={start:s(c.startContainer,c.startOffset),end:s(c.endContainer,c.endOffset),window:b,changed:false}};select.selectMarked=function(){function b(){if(a.start.node==a.end.node&&a.start.offset==a.end.offset){var e=a.window.getSelection();if(!e||e.rangeCount==0)return true;e=e.getRangeAt(0);e=s(e.startContainer,e.startOffset);return a.start.node!=e.node||a.start.offset!=e.offset}}function c(e,g){if(e.node)e.offset==0?f["set"+g+"Before"](e.node):f["set"+
g](e.node,e.offset);else f.setStartAfter(d.document.body.lastChild||d.document.body)}var a=j;if(a&&(a.changed||webkit&&b())){var d=a.window,f=d.document.createRange();c(a.end,"End");c(a.start,"Start");r(f,d)}};var r=function(b,c){var a=c.getSelection();if(a){a.removeAllRanges();a.addRange(b)}},q=function(b){b=b.getSelection();return!b||b.rangeCount==0?false:b.getRangeAt(0)};select.selectionTopNode=function(b,c){var a=q(b.ownerDocument.defaultView);if(!a)return false;var d=c?a.startContainer:a.endContainer,
f=c?a.startOffset:a.endOffset;window.opera&&!c&&a.endContainer==b&&a.endOffset==a.startOffset+1&&b.childNodes[a.startOffset]&&isBR(b.childNodes[a.startOffset])&&f--;return d.nodeType==3?f>0?o(d,b):t(d,b):d.nodeName.toUpperCase()=="HTML"?f==1?null:b.lastChild:d==b?f==0?null:d.childNodes[f-1]:f==d.childNodes.length?o(d,b):f==0?t(d,b):o(d.childNodes[f-1],b)};select.focusAfterNode=function(b,c){var a=c.ownerDocument.defaultView,d=a.document.createRange();d.setStartBefore(c.firstChild||c);if(b&&!b.firstChild)d.setEndAfter(b);
else b?d.setEnd(b,b.childNodes.length):d.setEndBefore(c.firstChild||c);d.collapse(false);r(d,a)};select.somethingSelected=function(b){return(b=q(b))&&!b.collapsed};select.offsetInNode=function(b,c){var a=q(b);if(!a)return 0;a=a.cloneRange();a.setStartBefore(c);return a.toString().length};var w=function(b,c){var a=q(b);if(a){a.deleteContents();a.insertNode(c);if(b.opera&&isBR(c)&&isSpan(c.parentNode)){a=c.nextSibling;var d=c.parentNode,f=d.parentNode;f.insertBefore(c,d.nextSibling);for(d="";a&&a.nodeType==
3;a=a.nextSibling){d+=a.nodeValue;removeElement(a)}f.insertBefore(makePartSpan(d,b.document),c.nextSibling)}a=b.document.createRange();a.selectNode(c);a.collapse(false);r(a,b)}};select.insertNewlineAtCursor=function(b){webkit?document.execCommand("insertLineBreak"):w(b,b.document.createElement("BR"))};select.insertTabAtCursor=function(b){w(b,b.document.createTextNode("\u00a0\u00a0\u00a0\u00a0"))};select.cursorPos=function(b,c){var a=q(window);if(a){for(var d=select.selectionTopNode(b,c);d&&!isBR(d);)d=
d.previousSibling;a=a.cloneRange();a.collapse(c);d?a.setStartAfter(d):a.setStartBefore(b);return{node:d,offset:a.toString().length}}};select.setCursorPos=function(b,c,a){function d(g,h,k){function m(n){n.nodeType==3?i.push(n):forEach(n.childNodes,m)}if(h==0&&g&&!g.nextSibling){e["set"+k+"After"](g);return true}if(g=g?g.nextSibling:b.firstChild){if(h==0){e["set"+k+"Before"](g);return true}for(var i=[];;){for(;g&&!i.length;){m(g);g=g.nextSibling}var l=i.shift();if(!l)return false;var p=l.nodeValue.length;
if(p>=h){e["set"+k](l,h);return true}h-=p}}}var f=b.ownerDocument.defaultView,e=f.document.createRange();a=a||c;d(a.node,a.offset,"End")&&d(c.node,c.offset,"Start")&&r(e,f)}}})();